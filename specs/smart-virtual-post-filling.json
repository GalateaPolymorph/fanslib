{
  "name": "Smart Virtual Post Filling",
  "description": "Streamlined workflow for assigning media to virtual posts with contextual filtering",
  "context": {
    "problem": "Pipeline auto-assignment creates posts that always need manual review and reassignment, making it slower than intentional curation",
    "user_need": "Click a virtual post and immediately see relevant, filtered media options to assign with minimal friction"
  },
  "scope": {
    "in_scope": [
      "Contextual media filtering when selecting a virtual post",
      "Quick media assignment from filtered view",
      "Navigation between unfilled slots",
      "Media repost prevention via cooldown filtering"
    ],
    "out_of_scope": [
      "AI-powered content recommendations",
      "Automated caption generation",
      "Cross-platform content optimization",
      "Complex scoring algorithms"
    ]
  },
  "features": [
    {
      "category": "ux",
      "description": "Morphing panel animation when clicking virtual post",
      "acceptance_criteria": [
        "Clicking virtual post in PostCalendar view opens simplified media selection panel",
        "Panel animates by morphing from clicked card boundaries outward",
        "Uses framer-motion layoutId for shared element transition",
        "Panel floats above calendar via portal (position: fixed)",
        "Semi-transparent backdrop appears behind, dimming the calendar",
        "Panel content (grid, controls) fades in after morph animation completes",
        "Click backdrop or press Escape closes panel with reverse animation",
        "Animation respects prefers-reduced-motion (instant transition when set)",
        "Panel is a simplified media selection UI, NOT the full CreatePostDialog"
      ],
      "passes": true
    },
    {
      "category": "ux",
      "description": "Simplified media selection panel layout",
      "acceptance_criteria": [
        "Panel anchored to original card position",
        "Panel expands to approximately 4 media grid items wide",
        "Smart positioning keeps panel within viewport bounds",
        "Panel header shows: date/time, content schedule badge with color, channel badge, close button",
        "MediaFilters component displayed above grid showing all active filters",
        "Scrollable grid displays filtered media for selection",
        "Panel footer shows: Expand button (opens full CreatePostDialog), Create Post button",
        "Create Post button creates the post, closes panel, and revalidates the calendar query",
        "Expand button opens full CreatePostDialog with current selection preserved"
      ],
      "passes": true
    },
    {
      "category": "functional",
      "description": "Pre-filter library based on schedule and channel configuration",
      "acceptance_criteria": [
        "Library is pre-filtered to schedule's mediaFilters",
        "Library is pre-filtered to channel's eligibleMediaFilter",
        "ScheduleChannel overrides apply when present",
        "Combined filters are additive (all must match)"
      ],
      "passes": true
    },
    {
      "category": "functional",
      "description": "Media repost cooldown filtering",
      "acceptance_criteria": [
        "Media posted to this channel within mediaRepostCooldownHours is hidden by default",
        "mediaRepostCooldownHours is configured per channel (default 720 hours / 30 days)",
        "User can toggle 'Show recently posted' to include media within cooldown period",
        "When shown, recently posted media has visual indicator but is not deprioritized"
      ],
      "passes": true
    },
    {
      "category": "functional",
      "description": "Sort options",
      "acceptance_criteria": [
        "Sort dropdown offers: Newest Added (default), Oldest Added, Recently Posted, Least Posted",
        "Newest/Oldest Added sorts by fileCreationDate",
        "Recently/Least Posted sorts by last post date to any channel",
        "Sort preference persists for the session"
      ],
      "passes": true
    },
    {
      "category": "ux",
      "description": "Visual posting history indicators",
      "acceptance_criteria": [
        "Thumbnails show indicator icon if media was posted to this channel before (outside cooldown)",
        "Hover tooltip shows when and where media was last posted",
        "Recently posted media (when shown via toggle) has distinct visual treatment"
      ],
      "passes": true
    },
    {
      "category": "ux",
      "description": "Filter refinement controls",
      "acceptance_criteria": [
        "Panel includes existing MediaFilters component for filter refinement",
        "User can add/remove filters using same UI as library browser",
        "Filter state resets when panel closes"
      ],
      "passes": true
    },
    {
      "category": "functional",
      "description": "Media selection behavior",
      "acceptance_criteria": [
        "Click thumbnail to select single media",
        "Shift-click for range selection",
        "Cmd/Ctrl-click for multi-select",
        "Drag to reorder selected media"
      ],
      "passes": true
    },
    {
      "category": "functional",
      "description": "Create post action",
      "acceptance_criteria": [
        "Create Post button creates post with selected media",
        "Post inherits date, channel, scheduleId from virtual post",
        "Cmd+Enter keyboard shortcut triggers Create Post",
        "Button disabled until at least one media selected",
        "After creation, panel closes and calendar query revalidates to show new post"
      ],
      "passes": true
    },
    {
      "category": "functional",
      "description": "Expand to full CreatePostDialog",
      "acceptance_criteria": [
        "Expand button opens full CreatePostDialog with all editing capabilities",
        "Current media selection is preserved when expanding",
        "Virtual post date, channel, and schedule context is passed to dialog",
        "User can edit caption, add hashtags, and configure all post options in full dialog",
        "Full dialog creation also revalidates calendar query on completion"
      ],
      "passes": true
    },
    {
      "category": "ux",
      "description": "Recent posts context display",
      "acceptance_criteria": [
        "Panel shows last 3 posts on this channel as small thumbnails",
        "Helps user avoid posting similar content consecutively",
        "Context display is collapsible to save space"
      ],
      "passes": true
    },
    {
      "category": "edge-case",
      "description": "Empty state when no eligible media",
      "acceptance_criteria": [
        "Clear message when filters result in empty media list",
        "Shows which filters are active and limiting results",
        "Option to skip this slot"
      ],
      "passes": true
    }
  ],
  "technical_notes": {
    "initial_implementation": "PostCalendar view only; PostSwimlane can be added later",
    "integrates_with": [
      "content-schedules (virtual posts, mediaFilters)",
      "channels (eligibleMediaFilter, mediaRepostCooldownHours)",
      "library (existing filter system, fetch-all endpoint)",
      "posts (creation, posting history for cooldown check)"
    ]
  }
}
